-- Malgorzata Krause & Martyna Skowronek

CREATE DATABASE bookrental;

USE bookrental;
CREATE TABLE Users (
    user_id INT AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    email VARCHAR(100),
    phone VARCHAR(9)
);

CREATE TABLE Categories (
    category_id INT AUTO_INCREMENT PRIMARY KEY,
    category_name VARCHAR(100)
);

CREATE TABLE Authors (
    author_id INT AUTO_INCREMENT PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    birth_date DATE,
    nationality VARCHAR(50)
);

CREATE TABLE Books (
    book_id INT AUTO_INCREMENT PRIMARY KEY,
    title VARCHAR(255) NOT NULL,
    author_id INT NOT NULL,
    publication_year VARCHAR(4),
    category_id INT,
    quantity_available INT,
    FOREIGN KEY (author_id) REFERENCES Authors(author_id),
    FOREIGN KEY (category_id) REFERENCES Categories(category_id)
);

CREATE TABLE Borrowings (
    borrowing_id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    book_id INT NOT NULL,
    borrowing_date DATE NOT NULL,
    return_date DATE,
    FOREIGN KEY (user_id) REFERENCES Users(user_id),
    FOREIGN KEY (book_id) REFERENCES Books(book_id)
);

CREATE TABLE Penalties (
    borrowing_id INT PRIMARY KEY,
    penalty_amount DECIMAL(10, 2),
    penalty_time INT,
    paid VARCHAR(3),
    FOREIGN KEY (borrowing_id) REFERENCES Borrowings(borrowing_id)
);

CREATE TABLE BookLocations (
    book_id INT PRIMARY KEY,
    shelf VARCHAR(20),
    aisle VARCHAR(20),
    FOREIGN KEY (book_id) REFERENCES Books(book_id)
);

CREATE TABLE Reviews (
    review_id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT NOT NULL,
    book_id INT NOT NULL,
    rating INT CHECK (rating BETWEEN 1 AND 5),
    FOREIGN KEY (user_id) REFERENCES Users(user_id),
    FOREIGN KEY (book_id) REFERENCES Books(book_id)
);



INSERT INTO Users (first_name, last_name, email, phone) VALUES
('John', 'Smith', 'john.smith@example.com', '123456789'),
('Anna', 'Johnson', 'anna.johnson@example.com', '987654321'),
('Robert', 'Brown', 'robert.brown@example.com', '456123789'),
('Emily', 'Davis', 'emily.davis@example.com', '321654987'),
('Michael', 'Wilson', 'michael.wilson@example.com', '789456123'),
('Sophia', 'Taylor', 'sophia.taylor@example.com', '654789321'),
('William', 'Martinez', 'william.martinez@example.com', '123789456'),
('Olivia', 'Garcia', 'olivia.garcia@example.com', '987321654'),
('James', 'Anderson', 'james.anderson@example.com', '789123654'),
('Charlotte', 'Moore', 'charlotte.moore@example.com', '456987123'),
('Liam', 'Harris', 'liam.harris@example.com', '852963741'),
('Isabella', 'Clark', 'isabella.clark@example.com', '963852741'),
('Ethan', 'Lewis', 'ethan.lewis@example.com', '741852963'),
('Ava', 'Young', 'ava.young@example.com', '159753486'),
('Mason', 'King', 'mason.king@example.com', '753159852'),
('Amelia', 'Scott', 'amelia.scott@example.com', '486159753'),
('Logan', 'Adams', 'logan.adams@example.com', '369258147'),
('Mia', 'Baker', 'mia.baker@example.com', '258369741'),
('Lucas', 'Nelson', 'lucas.nelson@example.com', '147852963'),
('Emma', 'Watson', 'emma.watson@example.com', '123456789'),
('Liam', 'Smith', 'liam.smith@example.com', '987654321'),
('Noah', 'Johnson', 'noah.johnson@example.com', '456123789'),
('Olivia', 'Brown', 'olivia.brown@example.com', '321654987'),
('Ava', 'Taylor', 'ava.taylor@example.com', '789456123'),
('Sophia', 'Martinez', 'sophia.martinez@example.com', '654789321'),
('Isabella', 'Garcia', 'isabella.garcia@example.com', '123789456'),
('Mason', 'Anderson', 'mason.anderson@example.com', '987321654'),
('Lucas', 'Moore', 'lucas.moore@example.com', '789123654'),
('Ethan', 'Harris', 'ethan.harris@example.com', '456987123'),
('Charlotte', 'Clark', 'charlotte.clark@example.com', '852963741'),
('Amelia', 'Lewis', 'amelia.lewis@example.com', '963852741'),
('Harper', 'Young', 'harper.young@example.com', '741852963'),
('James', 'King', 'james.king@example.com', '159753486'),
('Benjamin', 'Scott', 'benjamin.scott@example.com', '753159852'),
('Elijah', 'Adams', 'elijah.adams@example.com', '486159753'),
('Logan', 'Baker', 'logan.baker@example.com', '369258147'),
('Zoe', 'Nelson', 'zoe.nelson@example.com', '258369741'),
('William', 'Hill', 'william.hill@example.com', '147852963'),
('Jack', 'Green', 'jack.green@example.com', '159753852'),
('Ella', 'Carter', 'ella.carter@example.com', '753951852'),
('Grace', 'Mitchell', 'grace.mitchell@example.com', '369852741'),
('Alexander', 'Perez', 'alexander.perez@example.com', '741369852'),
('Daniel', 'Roberts', 'daniel.roberts@example.com', '258741963'),
('Scarlett', 'Turner', 'scarlett.turner@example.com', '963258741'),
('Victoria', 'Phillips', 'victoria.phillips@example.com', '654123987'),
('Henry', 'Evans', 'henry.evans@example.com', '123987654'),
('Samantha', 'Edwards', 'samantha.edwards@example.com', '789654321'),
('Matthew', 'Collins', 'matthew.collins@example.com', '321789456'),
('Chloe', 'Bell', 'chloe.bell@example.com', '987123654');


INSERT INTO Categories (category_name) VALUES
('Fantasy'),
('Drama'),
('Crime'),
('Sci-Fi'),
('Romance'),
('Biography'),
('Thriller'),
('Non-fiction'),
('Children'),
('Horror');

INSERT INTO Authors (first_name, last_name, birth_date, nationality) VALUES
('Andrzej', 'Sapkowski', '1948-06-21', 'Poland'),
('Fyodor', 'Dostoevsky', '1821-11-11', 'Russia'),
('Stanislaw', 'Lem', '1921-09-12', 'Poland'),
('George', 'Orwell', '1903-06-25', 'United Kingdom'),
('Jane', 'Austen', '1775-12-16', 'United Kingdom'),
('Stephen', 'King', '1947-09-21', 'United States'),
('Agatha', 'Christie', '1890-09-15', 'United Kingdom'),
('J.K.', 'Rowling', '1965-07-31', 'United Kingdom'),
('Mark', 'Twain', '1835-11-30', 'United States'),
('Charles', 'Dickens', '1812-02-07', 'United Kingdom'),
('Victor', 'Hugo', '1802-02-26', 'France'),
('Herman', 'Melville', '1819-08-01', 'United States'),
('Gabriel', 'Garcia Marquez', '1927-03-06', 'Colombia'),
('Jules', 'Verne', '1828-02-08', 'France'),
('Ernest', 'Hemingway', '1899-07-21', 'United States'),
('Franz', 'Kafka', '1883-07-03', 'Austria-Hungary'),
('Haruki', 'Murakami', '1949-01-12', 'Japan'),
('Leo', 'Tolstoy', '1828-09-09', 'Russia'),
('Albert', 'Camus', '1913-11-07', 'France'),
('J.R.R.', 'Tolkien', '1892-01-03', 'United Kingdom'),
('F. Scott', 'Fitzgerald', '1896-09-24', 'United States'),
('George', 'R.R. Martin', '1948-09-20', 'United States'),
('Margaret', 'Atwood', '1939-11-18', 'Canada'),
('Virginia', 'Woolf', '1882-01-25', 'United Kingdom'),
('James', 'Joyce', '1882-02-02', 'Ireland'),
('Harper', 'Lee', '1926-04-28', 'United States'),
('Kurt', 'Vonnegut', '1922-11-11', 'United States'),
('Chinua', 'Achebe', '1930-11-16', 'Nigeria'),
('Gabriel', 'Mistral', '1889-04-07', 'Chile'),
('Oscar', 'Wilde', '1854-10-16', 'Ireland'),
('Toni', 'Morrison', '1931-02-18', 'United States'),
('William', 'Faulkner', '1897-09-25', 'United States'),
('Arthur', 'Conan Doyle', '1859-05-22', 'United Kingdom'),
('J.D.', 'Salinger', '1919-01-01', 'United States'),
('Emily', 'Bronte', '1818-07-30', 'United Kingdom'),
('Anne', 'Rice', '1941-10-04', 'United States'),
('Ray', 'Bradbury', '1920-08-22', 'United States'),
('Suzanne', 'Collins', '1962-08-10', 'United States'),
('Dan', 'Brown', '1964-06-22', 'United States'),
('Paulo', 'Coelho', '1947-08-24', 'Brazil'),
('Kazuo', 'Ishiguro', '1954-11-08', 'United Kingdom'),
('Colleen', 'Hoover', '1979-12-11', 'United States'),
('John', 'Green', '1977-08-24', 'United States'),
('Anne', 'Frank', '1929-06-12', 'Germany'),
('E.B.', 'White', '1899-07-11', 'United States'),
('C.S.', 'Lewis', '1898-11-29', 'United Kingdom'),
('Dr.', 'Seuss', '1904-03-02', 'United States'),
('Stephenie', 'Meyer', '1973-12-24', 'United States'),
('Rick', 'Riordan', '1964-06-05', 'United States'),
('Beatrix', 'Potter', '1866-07-28', 'United Kingdom'),
('Roald', 'Dahl', '1916-09-13', 'United Kingdom'),
('J.M.', 'Barrie', '1860-05-09', 'United Kingdom'),
('L. Frank', 'Baum', '1856-05-15', 'United States'),
('Philip', 'Pullman', '1946-10-19', 'United Kingdom'),
('Khaled', 'Hosseini', '1965-03-04', 'Afghanistan'),
('Jhumpa', 'Lahiri', '1967-07-11', 'India'),
('Elena', 'Ferrante', '1943-04-09', 'Italy'),
('Marcel', 'Proust', '1871-07-10', 'France'),
('Isaac', 'Asimov', '1920-01-02', 'Russia');

INSERT INTO Books (title, author_id, publication_year, category_id, quantity_available) VALUES
('The Witcher', 1, 1993, 1, 5),
('BLA BLA', 2, 1967, 4, 4),
('Solaris', 3, 1961, 4, 4),
('1984', 4, 1949, 4, 6),
('Pride and Prejudice', 5, 1813, 5, 4),
('The Shining', 6, 1977, 10, 3),
('Murder on the Orient Express', 7, 1934, 3, 7),
('Harry Potter and the Sorcerer\'s Stone', 8, 1997, 1, 10),
('The Adventures of Tom Sawyer', 9, 1876, 9, 5),
('Foundation', 10, 1951, 4, 8),
('A Tale of Two Cities', 33, 1859, 2, 8),
('Les Mis√©rables', 11, 1862, 2, 6),
('Moby-Dick', 12, 1851, 2, 4),
('One Hundred Years of Solitude', 13, 1967, 1, 7),
('Around the World in Eighty Days', 14, 1872, 4, 10),
('The Old Man and the Sea', 15, 1952, 2, 5),
('The Metamorphosis', 16, 1915, 10, 3),
('Norwegian Wood', 17, 1987, 5, 7),
('War and Peace', 18, 1869, 2, 6),
('The Stranger', 19, 1942, 2, 5),
('The Hobbit', 20, 1937, 1, 12),
('The Great Gatsby', 21, 1925, 2, 8),
('A Game of Thrones', 22, 1996, 1, 4),
('The Handmaid\'s Tale', 23, 1985, 5, 6),
('Mrs. Dalloway', 24, 1925, 2, 3),
('Ulysses', 25, 1922, 2, 2),
('To Kill a Mockingbird', 26, 1960, 5, 6),
('Slaughterhouse-Five', 27, 1969, 10, 7),
('Things Fall Apart', 28, 1958, 3, 5),
('Wuthering Heights', 29, 1847, 5, 4),
('Twilight', 40, 2005, 5, 8),
('The Hunger Games', 41, 2008, 5, 12),
('The Catcher in the Rye', 34, 1951, 3, 5),
('The Chronicles of Narnia', 38, 1950, 1, 6),
('The Kite Runner', 49, 2003, 3, 7),
('Jane Eyre', 30, 1847, 5, 3),
('The Giver', 50, 1993, 9, 4),
('Brave New World', 31, 1932, 4, 6),
('The Book Thief', 32, 2005, 9, 5),
('Crime and Punishment', 2, 1866, 3, 6),
('Dracula', 35, 1897, 10, 4),
('The Lord of the Rings', 20, 1954, 1, 10),
('Fahrenheit 451', 36, 1953, 4, 6),
('Anne of Green Gables', 37, 1908, 9, 7),
('The Picture of Dorian Gray', 38, 1890, 10, 5),
('The Secret Garden', 39, 1911, 9, 8),
('Divergent', 42, 2011, 5, 11),
('The Fault in Our Stars', 43, 2012, 5, 10),
('Charlotte\'s Web', 37, 1952, 9, 6),
('The Alchemist', 44, 1988, 5, 12),
('Life of Pi', 45, 2001, 4, 8),
('The Girl on the Train', 46, 2015, 3, 7),
('The Maze Runner', 47, 2009, 5, 8),
('Water for Elephants', 48, 2006, 5, 6),
('The House of the Spirits', 49, 1982, 2, 4),
('Percy Jackson: The Lightning Thief', 50, 2005, 9, 10),
('Goodnight Moon', 51, 1947, 9, 12),
('The Velveteen Rabbit', 52, 1922, 9, 10),
('Matilda', 53, 1988, 9, 7),
('The Night Circus', 54, 2011, 1, 5),
('The Little Prince', 14, 1943, 9, 8),
('Holes', 55, 1998, 9, 6),
('Eragon', 56, 2002, 1, 10);

INSERT INTO Borrowings (user_id, book_id, borrowing_date, return_date) VALUES
(1, 1, '2024-10-01', '2024-10-15'),
(2, 1, '2024-11-01', '2024-11-10'),
(3, 1, '2024-12-01', NULL), 
(4, 2, '2024-09-10', '2024-09-20'),
(5, 2, '2024-11-15', '2024-11-25'),
(6, 3, '2024-07-05', '2024-07-15'),
(7, 3, '2024-12-01', NULL),
(8, 4, '2024-08-20', '2024-08-30'),
(9, 4, '2024-11-25', '2024-12-05'),
(10, 5, '2024-10-10', '2024-10-20'),
(11, 5, '2024-12-12', NULL),
(12, 6, '2024-09-01', '2024-09-10'),
(13, 6, '2024-12-08', '2024-12-18'),
(14, 7, '2024-11-13', NULL),
(15, 8, '2024-10-03', '2024-10-10'),
(16, 8, '2024-12-03', '2024-12-10'),
(17, 9, '2024-09-09', '2024-09-19'),
(18, 9, '2024-12-09', NULL),
(19, 10, '2024-07-05', '2024-07-15'),
(20, 10, '2024-12-05', '2024-12-15'),
(21, 11, '2024-09-01', '2024-09-21'),
(22, 12, '2024-08-05', NULL),
(23, 12, '2024-12-05', NULL),
(24, 13, '2024-06-10', '2024-06-20'),
(25, 13, '2024-12-10', '2024-12-20'),
(26, 14, '2024-10-07', '2024-10-22'),
(27, 14, '2024-12-07', '2024-12-22'),
(28, 15, '2024-09-15', '2024-09-25'),
(29, 15, '2024-12-15', NULL),
(30, 16, '2024-08-09', '2024-08-24'),
(31, 16, '2024-12-09', '2024-12-24'),
(32, 17, '2024-10-01', NULL),
(33, 18, '2024-07-03', '2024-07-13'),
(34, 18, '2024-12-03', '2024-12-13'),
(35, 19, '2024-06-12', '2024-06-18'),
(36, 19, '2024-12-12', '2024-12-18'),
(37, 20, '2024-09-08', NULL),
(38, 20, '2024-12-08', NULL);


INSERT INTO Penalties (borrowing_id, penalty_amount, penalty_time, paid)
SELECT 
    b.borrowing_id,
    CASE 
        WHEN DATEDIFF(COALESCE(b.return_date, CURDATE()), b.borrowing_date) > 14 THEN 
            (DATEDIFF(COALESCE(b.return_date, CURDATE()), b.borrowing_date) - 14) * 0.50 
        ELSE 
            0 
    END AS penalty_amount,
    DATEDIFF(COALESCE(b.return_date, CURDATE()), b.borrowing_date) - 14 AS penalty_time,
    'NO' AS paid 
FROM Borrowings b
WHERE b.return_date IS NULL OR DATEDIFF(COALESCE(b.return_date, CURDATE()), b.borrowing_date) > 14;


INSERT INTO BookLocations (book_id, shelf, aisle) VALUES
(1, 'A1', '1'),
(2, 'B2', '2'),
(3, 'C3', '3'),
(4, 'D4', '1'),
(5, 'E5', '2'),
(6, 'F6', '3'),
(7, 'G7', '4'),
(8, 'H8', '5'),
(9, 'I9', '6'),
(10, 'J10', '7'),
(11, 'A2', '8'),
(12, 'B3', '9'),
(13, 'C4', '10'),
(14, 'D5', '1'),
(15, 'E6', '2'),
(16, 'F7', '3'),
(17, 'G8', '4'),
(18, 'H9', '5'),
(19, 'I10', '6'),
(20, 'J1', '7'),
(21, 'A3', '8'),
(22, 'B4', '9'),
(23, 'C5', '10'),
(24, 'D6', '1'),
(25, 'E7', '2'),
(26, 'F8', '3'),
(27, 'G9', '4'),
(28, 'H10', '5'),
(29, 'I1', '6'),
(30, 'J2', '7'),
(31, 'A4', '8'),
(32, 'B5', '9'),
(33, 'C6', '10'),
(34, 'D7', '1'),
(35, 'E8', '2'),
(36, 'F9', '3'),
(37, 'G10', '4'),
(38, 'H1', '5'),
(39, 'I2', '6'),
(40, 'J3', '7'),
(41, 'A5', '8'),
(42, 'B6', '9'),
(43, 'C7', '10'),
(44, 'D8', '1'),
(45, 'E9', '2'),
(46, 'F10', '3'),
(47, 'G1', '4'),
(48, 'H2', '5'),
(49, 'I3', '6'),
(50, 'J4', '7'),
(51, 'A6', '8'),
(52, 'B7', '9'),
(53, 'C8', '10'),
(54, 'D9', '1'),
(55, 'E10', '2'),
(56, 'F1', '3');


INSERT INTO Reviews (user_id, book_id, rating) VALUES
(1, 1, 4),
(2, 1, 5),
(4, 2, 3),
(5, 2, NULL),
(6, 3, 4),
(8, 4, 5),
(9, 4, 3),
(10, 5, 4),
(12, 6, 5),
(13, 6, 3),
(15, 8, 4),
(17, 9, 5),
(19, 10, 3),
(21, 11, 4),
(24, 13, 5),
(25, 13, 3),
(26, 14, 4),
(28, 15, 5),
(30, 16, NULL),
(33, 18, 5),
(35, 19, 4),
(36, 19, NULL);





